# 自動開発プロジェクト憲法（Supreme Law of Auto-Dev）Version 2.0

この憲法は、プロジェクトにおける法であり、全てのAIエージェントおよび開発者はこれを遵守しなければならない。
違反した場合、セッションは直ちに停止され、ロールバックされる。

## 第1条【設計至上主義とコンテキスト境界】

1. **実装禁止の原則**: 詳細設計ファイル（`docs/be_design.md` または `docs/fe_design.md`）に記載されていないクラス、関数、コンポーネント、ファイルの実装を固く禁ずる。
2. **DDDディレクトリ構造の厳守**: すべてのバックエンドコードは `src/context/[BoundedContext]/[Layer]` の構造に従わなければならない。勝手にフラットな構造にしてはならない。
3. **自然言語の合意**: コードを書く前に、必ず自然言語による詳細設計を行い、ユーザーの承認を得なければならない。
4. **ドキュメントの更新**: 実装中に設計の不備に気づいた場合、独断でコードを修正せず、まず設計ドキュメントを修正し、整合性を保たなければならない。

## 第2条【RGRGサイクルの義務化】

1. **RGRGフロー**: 実装は必ず以下の4ステップで行わなければならない。
   - **RED**: 失敗するテストを書く。
   - **GREEN**: テストを通す最小限の実装をする。
   - **REFACTOR**: コードを整理し、重複を排除し、可読性を高める。
   - **GREEN CHECK**: リファクタ後もテストが通ることを確認する。
2. **テストの保護**: 実装に合わせてテストコードを安易に変更してはならない。テストは仕様であり、実装がテストに合わせるべきである。
3. **Colocationルール**: テストファイルは必ず対象コードと同じ階層の `tests/` ディレクトリに配置しなければならない。

## 第3条【GitフローとAIセルフレビュー】

1. **メインブランチの不可侵**: `main` および `dev` ブランチへの直接コミットを禁ずる。必ず作業用ブランチを切ること。
2. **コミットの粒度**:
   - `docs: 詳細設計の更新`（設計完了時）
   - `test: xxxのテストケース追加（Red）`（テスト作成時）
   - `feat: xxxの実装（Green）`（実装完了時）
   - `refactor: xxxの整理`（リファクタリング時）
3. **AIセルフレビュー**: マージリクエスト前には、必ず自身で「規定チェックリスト（型安全性、不要ファイル、設定不備）」を確認し、問題がないことを保証しなければならない。

## 第4条【技術スタックの固定（Golden Stack）】

1. **Golden Stackの遵守**: `skills/tech_stack.md` で定義された技術スタック（Bun, Elysia, Drizzle, Next.js, Biome等）以外のライブラリ、ツールを無断で導入してはならない。
2. **車輪の再発明の禁止**: 既存のユーティリティやライブラリで解決できる問題を、独自の関数で実装してはならない。

## 第5条【タスク進行とTODOの神聖化】

1. **逐次更新の義務**: タスクの開始時に対象のチェックボックスを確認し、完了時には**必ず**チェックを入れること。これを行わずに次のタスクに進んではならない。
2. **勝手な変更の禁止**: `tasks/TODO.md` の構造（フェーズ分けや手順）を、ユーザーの許可なく変更・削除してはならない。
3. **現在地の共有**: セッション開始時や区切りごとに、「現在 `tasks/TODO.md` のどこを実行中か」を宣言すること。

## 第6条【完了の定義（Definition of Done）】

1. **仕様の充足**: `requirements_detail.md` の要件を満たしていること。
2. **品質の保証**: 全てのテストがパスし（Green Check完了）、リンターエラーがないこと。
3. **証跡の記録**: `tasks/TODO.md` が更新され、作業ログが残されていること。
