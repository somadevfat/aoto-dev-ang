# ルールとワークフロー (Rules & Workflows)

エージェントの振る舞いをカスタマイズし、定型作業を自動化するための強力な機能です。

---

## 📜 ルール (Rules)

ルールは、エージェントが常に従うべき**制約やガイドライン**を定義します。

### 🏗️ 構成とレベル

- **グローバルルール**: `~/.gemini/GEMINI.md` に保存され、すべてのプロジェクトに適用されます。
- **ワークスペースルール**: プロジェクトルートの `.agent/rules/` に保存され、そのプロジェクトのみに適用されます。

### ⚡ 有効化のオプション

ルールごとに、どのように適用するかを選択できます。

| モード             | 説明                                                          |
| :----------------- | :------------------------------------------------------------ |
| **Always On**      | 常に適用されます。                                            |
| **Manual**         | `@ルール名` で明示的に指定したときのみ適用されます。          |
| **Model Decision** | AI が自然言語の説明を読み、必要と判断したときに適用されます。 |
| **Glob**           | 特定のファイル形式（例: `.ts`, `.py`）にのみ適用されます。    |

---

## 🔄 ワークフロー (Workflows)

ワークフローは、複数のステップからなる**一連の作業手順**を定義します。

- **スラッシュコマンド**: `/deploy` や `/test` のように呼び出すことができます。
- **手順の自動化**: 「ビルドして、テストを実行し、エラーがなければ通知する」といった複雑な軌道を AI に任せられます。
- **入れ子構造**: ワークフロー内から別のワークフローを呼び出すことも可能です。

### 🛠️ 作成方法

1. **Customizations** メニューから **Workflows** タブを選択。
2. `+ Global` または `+ Workspace` をクリックして手順を Markdown で記述。

> [!TIP]
> **エージェントに作らせる**: 複雑な作業を手動で終えた後、「さっきの工程をワークフローにして」と頼むのが最も簡単で確実な方法です。

---

## 🔗 @ Mentions (重要)

ルールやワークフローの中では、他のファイルを `@ファイル名` で参照できます。

- **相対パス**: その設定ファイルからの相対位置。
- **絶対パス**: リポジトリルートまたはシステム絶対パス。

---

## 💡 使い分けのポイント

- **ルール**: 「常にこの書き方をしてほしい」「このディレクトリは触らないで」といった**定常的な制約**に。
- **ワークフロー**: 「リリースの準備をして」「新しいコンポーネントの雛形を作って」といった**特定のアクション**に。
